<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Webstore Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="TiffyAI Web-Store Builder">
<meta property="og:description" content="Create your own web-store with live preview. Order via WhatsApp. Ready in minutes.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://tiffyai-usd.github.io/Web-Store-App/v2.html">
<meta property="og:image" content="https://tiffyai-usd.github.io/Web-Store-App/WebApp.gif">

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Inter',sans-serif;background:#0a0a0a;color:#e6e6e6}
:root{--gold:#d4a373;--gold2:#f1b86b;--whatsapp:#25D366}

header{
  min-height:80vh; background-size:cover; background-position:center;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  text-align:center; position:relative;
}
header::after{ content:''; position:absolute; inset:0; background:rgba(0,0,0,0.6); }
header *{position:relative;z-index:2}
.logo{ max-width:180px; border-radius:16px; border:3px solid var(--gold); margin-bottom:1rem; }
h1{font-family:'Bebas Neue';font-size:4rem;color:var(--gold)}
.tagline{font-family:'Bebas Neue';color:var(--gold)}

#menu{max-width:1200px;margin:auto;padding:4rem 5%}
.section-title{ font-family:'Bebas Neue'; font-size:2.4rem; color:var(--gold); margin:2rem 0 1rem; }
.menu-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:1.2rem; }
.menu-item{ background:#0f0f0f; border-radius:12px; border:1px solid #222; overflow:hidden; position: relative; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

.marketing-active .menu-item { border: 1px solid var(--gold); transform: scale(1.02); box-shadow: 0 0 15px rgba(212, 163, 115, 0.2); }

.badge { position: absolute; top: 15px; left: 15px; padding: 5px 12px; border-radius: 4px; font-family: 'Bebas Neue'; font-size: 0.9rem; z-index: 4; text-transform: uppercase; letter-spacing: 1px; }
.badge-scarcity { background: #ff0000; color: #fff; }
.badge-hot { background: var(--gold); color: #000; }
.badge-new { background: #3498db; color: #fff; }

.share-btn { position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.5); border: 1px solid var(--gold); color: var(--gold); border-radius: 50%; width: 38px; height: 38px; display: flex; align-items: center; justify-content: center; cursor: pointer; backdrop-filter: blur(5px); z-index: 5; }
.status-saver-btn { position: absolute; top: 10px; left: 10px; background: #25D366; color: #fff; border: none; padding: 6px 10px; border-radius: 20px; font-size: 0.7rem; font-family: 'Bebas Neue'; cursor: pointer; z-index: 5; }

.rating-stars { color: #ffcc00; margin-bottom: 5px; font-size: 0.9rem; }
.menu-item img{ width:100%; height:200px; object-fit:cover; border-bottom:3px solid var(--gold); }
.card{padding:1rem}
.menu-item h3{font-family:'Bebas Neue';color:var(--gold)}
.price{font-family:'Bebas Neue';color:var(--gold2)}

.sales-log { background: #000; padding: 10px; border-radius: 8px; max-height: 200px; overflow-y: auto; margin: 10px 0; border: 1px solid #333; }
.log-entry { display: flex; justify-content: space-between; padding: 8px; border-bottom: 1px solid #222; font-size: 0.8rem; align-items: center; }

.receipt-wrap { background: #fff !important; color: #000 !important; padding: 20px; width: 300px; margin: auto; display: none; font-family: 'Courier New', monospace; }
@media print { body * { display: none !important; } .receipt-wrap { display: block !important; } }

footer{ background:#000; padding:2rem; text-align:center; border-top:1px solid #222; color:#999; }

#editor{ background:rgba(10,10,10,0.9); border-top:3px dashed var(--gold); padding:3rem 5%; }
.editor-block{ background:rgba(20,20,20,0.92); padding:1.5rem; border-radius:14px; margin-bottom:2rem; }
label{display:block;margin-top:1rem;color:var(--gold)}
input,textarea,select{ width:100%; padding:10px; background:#222; border:1px solid #444; color:#fff; border-radius:6px; }
button{ background:linear-gradient(180deg,var(--gold),var(--gold2)); border:none; padding:10px 18px; border-radius:30px; font-family:'Bebas Neue'; font-size:1.1rem; cursor:pointer; margin-top:10px; }
.remove{background:#900;color:#fff}
.cloud-btn { background: #3498db; color: white; margin-bottom: 5px; font-size: 0.8rem; }

#whatsappOrderBtn{ position:fixed; bottom:20px; right:20px; z-index:999; background:linear-gradient(180deg,#25D366,#1ebe5d); color:#071010; padding:14px 22px; border-radius:40px; font-family:'Bebas Neue'; font-size:1.2rem; text-decoration:none; }
.quote-btn { position: fixed; bottom: 80px; right: 20px; z-index: 998; background: #fff; color: #000; padding: 10px 20px; border-radius: 30px; font-family: 'Bebas Neue'; cursor: pointer; border: none; }

.modal{ position:fixed; inset:0; background:rgba(0,0,0,0.75); display:flex; align-items:center; justify-content:center; z-index:2000; }
.hidden{display:none}
.modal-glass{ width:90%; max-width:420px; background:rgba(20,20,20,0.85); backdrop-filter:blur(14px); border:1px solid rgba(212,163,115,0.4); border-radius:20px; padding:2rem; color:#fff; }
.activation{ max-width:600px; margin:3rem auto; padding:2rem; border-top:1px dashed var(--gold); text-align:center; }
.code-inputs{ display:flex; justify-content:center; gap:10px; margin-bottom:1.5rem; }
.code-inputs input{ width:42px; height:52px; text-align:center; font-size:1.4rem; border-radius:8px; background:#111; border:1px solid #444; color:#fff; }
</style>
</head>

<body>
<div id="paymentModal" class="modal hidden">
  <div class="modal-glass">
    <h2 style="font-family:'Bebas Neue'; color:var(--gold); text-align:center;">TiffyAI Web-Store Builder</h2>
    <p style="text-align:center; margin:1rem 0;">$30 USD once-off lifetime license.</p>
    <button style="width:100%" onclick="window.open('https://wa.me/27766314246?text=Payment','_blank')">Pay for Activation</button>
    <button style="background:none; color:#aaa; width:100%; margin-top:10px;" onclick="closePayment()">Cancel</button>
  </div>
</div>

<header id="header">
  <img id="logo" class="logo">
  <h1 id="cafeName">BUSINESS NAME</h1>
  <p id="tagline" class="tagline">YOUR TAGLINE HERE</p>
</header>

<section id="menu"><div id="menuRender"></div></section>

<footer><p id="footerText">¬© 2026 YOUR BUSINESS</p></footer>

<div id="activationPanel" class="activation">
  <h3 style="font-family:'Bebas Neue'; color:var(--gold);">Activate Your Web-Store</h3>
  <div class="code-inputs">
    <input maxlength="1"><input maxlength="1"><input maxlength="1"><input maxlength="1"><input maxlength="1"><input maxlength="1"><input maxlength="1">
  </div>
  <button onclick="submitActivation()">Activate & Unlock Download</button>
</div>
 
<div id="editor">
<h2 style="font-family:'Bebas Neue';color:var(--gold)">BUSINESS INFO</h2>
<div class="editor-block">
  <label>Business Name</label><input oninput="document.getElementById('cafeName').textContent=this.value">
  <label>Tagline</label><input oninput="document.getElementById('tagline').textContent=this.value">
  <label>Footer Copyright</label><input oninput="document.getElementById('footerText').textContent=this.value">
  
  <label>Logo URL</label>
  <button class="cloud-btn" onclick="this.nextElementSibling.nextElementSibling.click()">‚òÅÔ∏è UPLOAD LOGO</button>
  <input id="logoPath" oninput="document.getElementById('logo').src=this.value">
  <input type="file" style="display:none" onchange="uploadImage(this, img=>{document.getElementById('logo').src=img; document.getElementById('logoPath').value=img;})">

  <label>Banner URL</label>
  <button class="cloud-btn" onclick="this.nextElementSibling.nextElementSibling.click()">‚òÅÔ∏è UPLOAD BANNER</button>
  <input id="bannerPath" oninput="document.getElementById('header').style.backgroundImage='url('+this.value+')'">
  <input type="file" style="display:none" onchange="uploadImage(this, img=>{document.getElementById('header').style.backgroundImage='url('+img+')'; document.getElementById('bannerPath').value=img;})">

  <label>WhatsApp Number</label>
  <input value="+27660000000" oninput="whatsappNumber=this.value.replace(/[^0-9+]/g,'')">
  <label>Currency</label>
  <select onchange="setCurrency(this.value)">
      <option value="ZAR">ZAR (R)</option><option value="INR">INR (‚Çπ)</option>
      <option value="USD">USD ($)</option><option value="EUR">EUR (‚Ç¨)</option>
      <option value="GBP">GBP (¬£)</option><option value="NGN">NGN (‚Ç¶)</option>
  </select>
  <button onclick="toggleMarketingMode()" id="mktBtn" style="width:100%; margin-top:20px; background:#1a1a1a; color:var(--gold); border:1px solid var(--gold);">‚ö° MARKETING MODE: OFF</button>
</div>

<h2 style="font-family:'Bebas Neue';color:var(--gold)">POS & SALES LOG</h2>
<div class="editor-block">
  <div id="salesLog" class="sales-log"></div>
  <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
      <button onclick="printZReading()" style="background:#fff; color:#000;">üìë Z-READING</button>
      <button onclick="resetSales()" style="background:#900; color:#fff;">üóëÔ∏è RESET LOG</button>
  </div>
</div>

<h2 style="font-family:'Bebas Neue';color:var(--gold)">MENU BUILDER</h2>
<div id="menuEditor"></div>
<button onclick="addSection()">+ ADD SECTION</button>
<button onclick="downloadHTML()" style="width:100%; padding:20px; font-size:1.5rem; margin-top:20px;">DOWNLOAD WEBSTORE HTML</button>
</div>

<div id="receiptArea" class="receipt-wrap">
    <center><h2 id="r-biz"></h2><p id="r-date"></p></center>
    <hr style="border:1px dashed #000; margin:10px 0;">
    <div id="r-items" style="white-space: pre-wrap; margin-bottom:10px; font-size:12px;"></div>
    <hr style="border:1px dashed #000; margin:10px 0;">
    <h3 id="r-total" style="text-align:right"></h3>
</div>

<canvas id="statusCanvas" width="1080" height="1920" style="display:none;"></canvas>

<script>
let whatsappNumber = "+27660000000";
let marketingMode = false;
let activeCurrency = 'ZAR';
const orderState = {};
const currencyMap = { ZAR: 'R', INR: '‚Çπ', USD: '$', EUR: '‚Ç¨', GBP: '¬£', NGN: '‚Ç¶' };

let menuSections = [{ title: "Products", items: [{ name: 'Sample Item', price: 100, desc: "Sample description", img: "", rating: 5, badge: 'none', stock: 5 }] }];

function setCurrency(c){ activeCurrency=c; renderMenu(); renderEditor(); }

function toggleMarketingMode() { 
  marketingMode = !marketingMode; 
  const btn = document.getElementById('mktBtn');
  document.body.classList.toggle('marketing-active'); 
  btn.style.background = marketingMode ? "var(--whatsapp)" : "#1a1a1a";
  btn.style.color = marketingMode ? "#000" : "var(--gold)";
  btn.textContent = marketingMode ? "‚ö° MARKETING MODE: ACTIVE" : "‚ö° MARKETING MODE: OFF";
  renderMenu(); 
}

function uploadImage(input, cb){ const f = input.files[0]; if (!f) return; const r = new FileReader(); r.onload = e => cb(e.target.result); r.readAsDataURL(f); }

function renderMenu(){
  const menuRender = document.getElementById('menuRender');
  menuRender.innerHTML = '';
  const sym = currencyMap[activeCurrency];

  menuSections.forEach((sec, s) => {
    const h2 = document.createElement('h2'); h2.className = 'section-title'; h2.textContent = sec.title;
    const grid = document.createElement('div'); grid.className = 'menu-grid';

    sec.items.forEach((it, i) => {
      const key = `${s}-${i}`;
      const qty = orderState[key] || 0;
      let badgeHtml = (marketingMode && it.badge !== 'none') ? `<div class="badge badge-${it.badge}">${it.badge === 'scarcity' ? 'ONLY '+it.stock+' LEFT' : it.badge}</div>` : '';

      grid.innerHTML += `
        <div class="menu-item">
          ${badgeHtml}
          ${marketingMode ? `<button class="status-saver-btn" onclick='generateStatusFlyer(${JSON.stringify(it)})'>üì≤ STATUS</button>
          <div class="share-btn" onclick="shareItem('${it.name}', ${it.price}, '${it.desc}')">üîó</div>` : ''}
          <img src="${it.img || 'https://via.placeholder.com/300'}">
          <div class="card">
            <h3>${it.name}</h3>
            <p style="font-size:0.8rem; color:#aaa; margin:5px 0;">${it.desc}</p>
            <div class="price">${it.price == 0 ? 'NEGOTIABLE' : sym + it.price}</div>
            <div style="display:flex;gap:10px;margin-top:10px;align-items:center">
               <button onclick="changeQty('${key}', -1)">‚àí</button><strong>${qty}</strong><button onclick="changeQty('${key}', 1)">+</button>
            </div>
          </div>
        </div>`;
    });
    menuRender.appendChild(h2); menuRender.appendChild(grid);
  });
  renderWhatsapp();
}

function changeQty(key, delta){ orderState[key] = Math.max(0, (orderState[key] || 0) + delta); renderMenu(); }

function renderWhatsapp(){
  const totalQty = Object.values(orderState).reduce((a,b)=>a+b,0);
  let btn = document.getElementById('whatsappOrderBtn');
  let qBtn = document.getElementById('quoteBtn');

  if (totalQty === 0){ if(btn) btn.remove(); if(qBtn) qBtn.remove(); return; }
  
  const sym = currencyMap[activeCurrency];
  let msgLines = ""; let grand = 0;
  menuSections.forEach((sec, s)=>{
    sec.items.forEach((it, i)=>{
      const q = orderState[`${s}-${i}`] || 0;
      if(q){ grand += (q * it.price); msgLines += `${q}x ${it.name} - ${sym}${q*it.price}\n`; }
    });
  });

  if(!btn){
    btn = document.createElement('a'); btn.id = 'whatsappOrderBtn'; document.body.appendChild(btn);
    qBtn = document.createElement('button'); qBtn.id = 'quoteBtn'; qBtn.className = 'quote-btn';
    qBtn.textContent = "üìÑ PRINT QUOTE"; qBtn.onclick = () => { printReceipt({date: new Date().toLocaleString(), total: grand, msg: msgLines}); };
    document.body.appendChild(qBtn);
  }
  btn.onclick = () => logSale(msgLines, grand);
  btn.href = `https://wa.me/${whatsappNumber}?text=` + encodeURIComponent(`üõçÔ∏è NEW ORDER\n\n${msgLines}\nTOTAL: ${sym}${grand}\n\nShop: ${window.location.href}`);
  btn.textContent = `ORDER NOW (${totalQty})`;
}

function logSale(msg, total) {
    const sales = JSON.parse(localStorage.getItem('tiffyai_sales') || '[]');
    sales.unshift({ date: new Date().toLocaleString(), total: total, msg: msg });
    localStorage.setItem('tiffyai_sales', JSON.stringify(sales));
    renderSalesLog();
}

function renderSalesLog() {
    const log = document.getElementById('salesLog');
    const sales = JSON.parse(localStorage.getItem('tiffyai_sales') || '[]');
    log.innerHTML = sales.map(s => `
        <div class="log-entry">
            <span>${s.date.split(',')[1]} - <strong>${currencyMap[activeCurrency]}${s.total}</strong></span>
            <button onclick='printReceipt(${JSON.stringify(s)})' style="padding:2px 8px; font-size:10px;">PRINT</button>
        </div>
    `).join('') || '<p style="font-size:12px; opacity:0.5;">Empty Log.</p>';
}

function resetSales(){ if(confirm("Clear Sales?")){ localStorage.removeItem('tiffyai_sales'); renderSalesLog(); }}

function printZReading(){
    const sales = JSON.parse(localStorage.getItem('tiffyai_sales') || '[]');
    const total = sales.reduce((a,b)=> a + parseFloat(b.total), 0);
    printReceipt({ date: new Date().toLocaleString(), total: total.toFixed(2), msg: `Z-READING SUMMARY\nSales Count: ${sales.length}` });
}

function printReceipt(s) {
    document.getElementById('r-biz').innerText = document.getElementById('cafeName').value || "STORE";
    document.getElementById('r-date').innerText = s.date;
    document.getElementById('r-items').innerText = s.msg;
    document.getElementById('r-total').innerText = "TOTAL: " + currencyMap[activeCurrency] + s.total;
    setTimeout(() => { window.print(); }, 500);
}

function generateStatusFlyer(it) {
  const canvas = document.getElementById('statusCanvas'); const ctx = canvas.getContext('2d');
  const biz = document.getElementById('cafeName').value || "Store";
  ctx.fillStyle = '#0a0a0a'; ctx.fillRect(0,0,1080,1920);
  const img = new Image(); img.crossOrigin = "anonymous"; img.src = it.img || 'https://via.placeholder.com/600';
  img.onload = () => {
    ctx.drawImage(img, 0, 300, 1080, 1080);
    ctx.fillStyle = "rgba(212,163,115,0.9)"; ctx.fillRect(0, 1400, 1080, 250);
    ctx.fillStyle = "#000"; ctx.font = "bold 90px Arial"; ctx.textAlign = "center";
    ctx.fillText(it.name.toUpperCase(), 540, 1500);
    ctx.font = "bold 130px Arial"; ctx.fillText(currencyMap[activeCurrency] + it.price, 540, 1620);
    const link = document.createElement('a'); link.download='flyer.png'; link.href=canvas.toDataURL(); link.click();
  };
}

function renderEditor(){
  const me = document.getElementById('menuEditor'); me.innerHTML = '';
  menuSections.forEach((sec, s)=>{
    const b = document.createElement('div'); b.className = 'editor-block';
    b.innerHTML = `<label>Section Title</label><input value="${sec.title}" oninput="menuSections[${s}].title=this.value;renderMenu()">
      ${sec.items.map((it,i)=>`<div style="border-top:1px solid #333; margin-top:10px; padding-top:10px;">
          <input value="${it.name}" placeholder="Name" oninput="menuSections[${s}].items[${i}].name=this.value;renderMenu()">
          <input type="number" value="${it.price}" placeholder="Price" oninput="menuSections[${s}].items[${i}].price=this.value;renderMenu()">
          <textarea placeholder="Desc" oninput="menuSections[${s}].items[${i}].desc=this.value;renderMenu()">${it.desc}</textarea>
          <button class="cloud-btn" onclick="this.nextElementSibling.nextElementSibling.click()">‚òÅÔ∏è UPLOAD IMG</button>
          <input value="${it.img}" oninput="menuSections[${s}].items[${i}].img=this.value;renderMenu()">
          <input type="file" style="display:none" onchange="uploadImage(this,img=>{menuSections[${s}].items[${i}].img=img;renderMenu()})">
          <button class="remove" onclick="menuSections[${s}].items.splice(${i},1);renderEditor();renderMenu()">Remove</button>
        </div>`).join('')}
      <button onclick="menuSections[${s}].items.push({name:'New Item',price:0,desc:'',img:'',rating:5,badge:'none',stock:5});renderEditor();renderMenu()">+ Add Item</button>`;
    me.appendChild(b);
  });
}

function addSection(){ menuSections.push({ title: "New Section", items: [] }); renderEditor(); renderMenu(); }

function downloadHTML(){
  if(localStorage.getItem('tiffyai_activated') === 'true'){ actualDownload(); return; }
  document.getElementById('paymentModal').classList.remove('hidden');
}

function actualDownload(){
  const doc = document.documentElement.cloneNode(true);
  doc.querySelector('#editor').remove(); doc.querySelector('#paymentModal').remove(); doc.querySelector('#activationPanel').remove();
  const script = Array.from(doc.querySelectorAll('script')).find(s => s.textContent.includes('let menuSections'));
  script.textContent = `let whatsappNumber = "${whatsappNumber}"; let activeCurrency = "${activeCurrency}"; let menuSections = ${JSON.stringify(menuSections)};` + script.textContent.split('let menuSections =')[1].split(';')[1];
  const blob = new Blob(['<!DOCTYPE html>\n' + doc.outerHTML], { type: 'text/html' });
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'WebStore.html'; a.click();
}

function closePayment(){ document.getElementById('paymentModal').classList.add('hidden'); }
function submitActivation(){
  const ent = Array.from(document.querySelectorAll('.code-inputs input')).map(i=>i.value).join('');
  if(ent === '1234567'){ localStorage.setItem('tiffyai_activated', 'true'); location.reload(); } else { alert('Invalid'); }
}

document.addEventListener('DOMContentLoaded', () => { 
  if(localStorage.getItem('tiffyai_activated') === 'true') document.getElementById('activationPanel').remove();
  renderMenu(); renderEditor(); renderSalesLog(); 
});
</script>
</body>
</html>
